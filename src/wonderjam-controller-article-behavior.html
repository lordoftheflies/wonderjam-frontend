<link rel="import" href="plutonium-widget-bound-beavior.html">

<script>
    (function () {
        'use strict';

        window.WonderjamAppBehaviors = window.WonderjamAppBehaviors || {};

        /**
         * Article controller behavior,
         *
         * @polymerBehavior
         */
        WonderjamAppBehaviors.ControllerArticleBehaviorImpl = {
            properties: {
                /**
                 * Root article.
                 * @type {{elements: Array<HTMLElement>, level: number}}
                 */
                rootModel: {
                    type: Object,
                    notify: true
                },
                /**
                 * Array for parent articles path.
                 * @type {{elements: Array<HTMLElement>, level: number}}
                 */
                parentModel: {
                    type: Object,
                    notify: true
                },
                /**
                 * Array for article content chidren.
                 * @type {{elements: Array<HTMLElement>, level: number}}
                 */
                contentChildrenModel: {
                    type: Object,
                    notify: true
                },
                
                /**
                 * Table of contents request parameters.
                 * @type {{pageId: String, tag: String, owner: String}}
                 */
                tocRequestParams: {
                    type: Object,
                    notify: true,
                    value: {}
                },
                /**
                 * Article information request parameters.
                 * @type {{pageId: String}}
                 */
                infoRequestParams: {
                    type: Object,
                    notify: true,
                    value: {}
                },
                /**
                 * Sub-route parameters for members page.
                 * @type {{elements: Array<HTMLElement>, level: number}}
                 */
                contentSubrouteData: {
                    type: Object,
                    notify: true
                }
                
            },
            observers: [
                'observeContentSubrouteData(contentSubrouteData, selectedContentFolder)'
            ],
            /**
             * Content page sub routing observer.
             * @param {{contentId: String}} contentSubrouteData
             * @param {String} selectedContentFolder
             * @returns {undefined}
             */
            observeContentSubrouteData: function (contentSubrouteData, selectedContentFolder) {
                console.log(this.is, 'observe route', this.contentSubrouteData);
                this.tocRequestParams.pageId = contentSubrouteData.contentId;
                this.tocRequestParams.tag = selectedContentFolder;
                this.tocRequestParams.owner = this.accountId;
            },
            /**
             * Ajax response handler for `childTocAjax` element.
             */
            onChildTocAjaxResponse: function (event, detail) {
                console.log(this.is, 'fetched article child contents for', this.contentSubrouteData.contentId);
            },
            /**
             * Ajax error handler for `childTocAjax` element.
             */
            onChildTocAjaxError: function (event, detail) {
                console.error(this.is, 'article child contents fetching failed for', this.contentSubrouteData.contentId);
            },
            /**
             * Ajax response handler for `parentTocAjax` element.
             */
            onParentTocAjaxResponse: function (event, detail) {
                console.log(this.is, 'fetched article parent path for', this.contentSubrouteData.contentId);
            },
            /**
             * Ajax error handler for `parentTocAjax` element.
             */
            onParentTocAjaxError: function (event, detail) {
                console.error(this.is, 'article parent path fetching failed for', this.contentSubrouteData.contentId);
                this.selectedContentFolder = 'public';
            }

        };


        WonderjamAppBehaviors.ControllerArticleBehavior = [
            PlutoniumBehaviors.WidgetBoundBehavior,
            WonderjamAppBehaviors.ControllerArticleBehaviorImpl
        ];

    })();
</script>